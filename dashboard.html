<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard - SineDay</title>
  <link rel="stylesheet" href="/styles.css">
  <link rel="stylesheet" href="/css/dashboard.css">
</head>
<body>
  <a class="skip-link" href="#main-content">Skip to main content</a>

  <div id="notifications" class="notifications" role="status" aria-live="polite" aria-atomic="true"></div>


  <main id="main-content">
    <div id="app">
    <div id="loading" class="loading" role="status" aria-live="polite" aria-atomic="true" style="display:none;">
      Loading...
    </div>
    <!-- Dashboard Section -->
    <section id="dashboard-section" style="display: none;">
      <header class="dash-topbar" role="banner">
        <div class="dash-left">
          <h1 class="dash-title">SineDay Sines</h1>
          <div id="mini-sub-pill" class="sub-pill" aria-live="polite"></div>
        </div>

        <div class="dash-right">
          <span class="dash-user">
            <span class="text-muted">Signed in:</span>
            <span id="user-email">user@example.com</span>
          </span>

          <button id="upgrade-btn" class="btn btn-primary btn-sm" style="display:none;">Upgrade</button>
          <button id="billing-btn" class="btn btn-secondary btn-sm" style="display:none;">Manage Billing</button>
          <button id="signout-btn" class="btn btn-secondary btn-sm">Sign Out</button>

          <a href="/" class="back-link">‚Üê Home</a>
        </div>
      </header>

      <!-- Optional: keep full status details but collapse it -->
      <div class="container container-compact">
        <details class="sub-details">
          <summary>Subscription</summary>
          <div id="subscription-status" style="margin-top:12px;"></div>
        </details>
      </div>

      <!-- Profiles Section -->
      <div class="container">
        <h2>Your Profiles</h2>
        <p class="text-muted">Manage up to 10 profiles for yourself or others.</p>

        <!-- Origin Duck Carousel -->
        <div id="duck-carousel-wrap" class="duck-carousel-wrap">
          <div class="duck-carousel-header">
            <div>
              <h3 class="duck-carousel-title">Your Origin Ducks</h3>
              <p class="text-muted duck-carousel-subtitle">
                Each profile's origin duck and current SineDay wave position.
              </p>
            </div>
          </div>
          <!-- Carousel renders here via JS -->
        </div>

        <!-- Keep the list for management + accessibility -->
        <details class="profiles-details">
          <summary>Manage profiles (list)</summary>
          <div id="profiles-list"></div>
        </details>

        <div id="profile-limit-message">
          <strong>Profile limit reached!</strong> You can have a maximum of 10 profiles.
        </div>

        <h3>Add New Profile</h3>
        <form id="add-profile-form">
          <div class="form-group">
            <label for="profile-name">Name</label>
            <input type="text" id="profile-name" placeholder="John Doe" required>
          </div>

          <div class="form-group">
            <label for="profile-birthdate">Birthdate</label>
            <input type="date" id="profile-birthdate" required>
          </div>

          <div class="form-group">
            <label for="profile-timezone">Timezone</label>
            <select id="profile-timezone">
              <option value="America/Chicago">America/Chicago (Central)</option>
              <option value="America/New_York">America/New_York (Eastern)</option>
              <option value="America/Los_Angeles">America/Los_Angeles (Pacific)</option>
              <option value="America/Denver">America/Denver (Mountain)</option>
              <option value="Europe/London">Europe/London</option>
              <option value="Europe/Paris">Europe/Paris</option>
              <option value="Asia/Tokyo">Asia/Tokyo</option>
              <option value="Asia/Shanghai">Asia/Shanghai</option>
              <option value="Australia/Sydney">Australia/Sydney</option>
            </select>
          </div>

          <button type="submit" id="add-profile-btn" class="btn btn-primary">Add Profile</button>
        </form>
      </div>

      <!-- Calendars Section (Gated) -->
      <div class="container">
        <h2>Your Calendars</h2>
        <div id="calendars-section"></div>
      </div>
    </section>
    </div>
  </main>

  <!-- Footer -->
  <footer class="site-footer">
    <a href="/accessibility.html">Accessibility</a>
  </footer>

  <!-- Load Supabase from CDN -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <!-- Load our modules -->
  <script type="module" src="/js/supabase-client.js"></script>
  <script type="module" src="/js/dashboard.js"></script>
</body>
</html>
